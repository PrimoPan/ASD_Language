{"ast":null,"code":"'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addMatrices = addMatrices;\nexports.decomposeMatrix = decomposeMatrix;\nexports.decomposeMatrixIntoMatricesAndAngles = decomposeMatrixIntoMatricesAndAngles;\nexports.flatten = flatten;\nexports.getRotationMatrix = getRotationMatrix;\nexports.isAffineMatrix = isAffineMatrix;\nexports.isAffineMatrixFlat = isAffineMatrixFlat;\nexports.multiplyMatrices = multiplyMatrices;\nexports.scaleMatrix = scaleMatrix;\nexports.subtractMatrices = subtractMatrices;\nexports.unflatten = unflatten;\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _errors = require(\"../../errors.js\");\nfunction isAffineMatrixFlat(x) {\n  'worklet';\n\n  return Array.isArray(x) && x.length === 16 && x.every(function (element) {\n    return typeof element === 'number' && !isNaN(element);\n  });\n}\nfunction isAffineMatrix(x) {\n  'worklet';\n\n  return Array.isArray(x) && x.length === 4 && x.every(function (row) {\n    return Array.isArray(row) && row.length === 4 && row.every(function (element) {\n      return typeof element === 'number' && !isNaN(element);\n    });\n  });\n}\nfunction flatten(matrix) {\n  'worklet';\n\n  return matrix.flat();\n}\nfunction unflatten(m) {\n  'worklet';\n\n  return [[m[0], m[1], m[2], m[3]], [m[4], m[5], m[6], m[7]], [m[8], m[9], m[10], m[11]], [m[12], m[13], m[14], m[15]]];\n}\nfunction maybeFlattenMatrix(matrix) {\n  'worklet';\n\n  return isAffineMatrix(matrix) ? flatten(matrix) : matrix;\n}\nfunction multiplyMatrices(a, b) {\n  'worklet';\n\n  return [[a[0][0] * b[0][0] + a[0][1] * b[1][0] + a[0][2] * b[2][0] + a[0][3] * b[3][0], a[0][0] * b[0][1] + a[0][1] * b[1][1] + a[0][2] * b[2][1] + a[0][3] * b[3][1], a[0][0] * b[0][2] + a[0][1] * b[1][2] + a[0][2] * b[2][2] + a[0][3] * b[3][2], a[0][0] * b[0][3] + a[0][1] * b[1][3] + a[0][2] * b[2][3] + a[0][3] * b[3][3]], [a[1][0] * b[0][0] + a[1][1] * b[1][0] + a[1][2] * b[2][0] + a[1][3] * b[3][0], a[1][0] * b[0][1] + a[1][1] * b[1][1] + a[1][2] * b[2][1] + a[1][3] * b[3][1], a[1][0] * b[0][2] + a[1][1] * b[1][2] + a[1][2] * b[2][2] + a[1][3] * b[3][2], a[1][0] * b[0][3] + a[1][1] * b[1][3] + a[1][2] * b[2][3] + a[1][3] * b[3][3]], [a[2][0] * b[0][0] + a[2][1] * b[1][0] + a[2][2] * b[2][0] + a[2][3] * b[3][0], a[2][0] * b[0][1] + a[2][1] * b[1][1] + a[2][2] * b[2][1] + a[2][3] * b[3][1], a[2][0] * b[0][2] + a[2][1] * b[1][2] + a[2][2] * b[2][2] + a[2][3] * b[3][2], a[2][0] * b[0][3] + a[2][1] * b[1][3] + a[2][2] * b[2][3] + a[2][3] * b[3][3]], [a[3][0] * b[0][0] + a[3][1] * b[1][0] + a[3][2] * b[2][0] + a[3][3] * b[3][0], a[3][0] * b[0][1] + a[3][1] * b[1][1] + a[3][2] * b[2][1] + a[3][3] * b[3][1], a[3][0] * b[0][2] + a[3][1] * b[1][2] + a[3][2] * b[2][2] + a[3][3] * b[3][2], a[3][0] * b[0][3] + a[3][1] * b[1][3] + a[3][2] * b[2][3] + a[3][3] * b[3][3]]];\n}\nfunction subtractMatrices(maybeFlatA, maybeFlatB) {\n  'worklet';\n\n  var isFlatOnStart = isAffineMatrixFlat(maybeFlatA);\n  var a = maybeFlattenMatrix(maybeFlatA);\n  var b = maybeFlattenMatrix(maybeFlatB);\n  var c = a.map(function (_, i) {\n    return a[i] - b[i];\n  });\n  return isFlatOnStart ? c : unflatten(c);\n}\nfunction addMatrices(maybeFlatA, maybeFlatB) {\n  'worklet';\n\n  var isFlatOnStart = isAffineMatrixFlat(maybeFlatA);\n  var a = maybeFlattenMatrix(maybeFlatA);\n  var b = maybeFlattenMatrix(maybeFlatB);\n  var c = a.map(function (_, i) {\n    return a[i] + b[i];\n  });\n  return isFlatOnStart ? c : unflatten(c);\n}\nfunction scaleMatrix(maybeFlatA, scalar) {\n  'worklet';\n\n  var isFlatOnStart = isAffineMatrixFlat(maybeFlatA);\n  var a = maybeFlattenMatrix(maybeFlatA);\n  var b = a.map(function (x) {\n    return x * scalar;\n  });\n  return isFlatOnStart ? b : unflatten(b);\n}\nfunction getRotationMatrix(angle) {\n  'worklet';\n\n  var axis = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'z';\n  var cos = Math.cos(angle);\n  var sin = Math.sin(angle);\n  switch (axis) {\n    case 'z':\n      return [[cos, sin, 0, 0], [-sin, cos, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]];\n    case 'y':\n      return [[cos, 0, -sin, 0], [0, 1, 0, 0], [sin, 0, cos, 0], [0, 0, 0, 1]];\n    case 'x':\n      return [[1, 0, 0, 0], [0, cos, sin, 0], [0, -sin, cos, 0], [0, 0, 0, 1]];\n  }\n}\nfunction norm3d(x, y, z) {\n  'worklet';\n\n  return Math.sqrt(x * x + y * y + z * z);\n}\nfunction transposeMatrix(matrix) {\n  'worklet';\n\n  var m = flatten(matrix);\n  return [[m[0], m[4], m[8], m[12]], [m[1], m[5], m[9], m[13]], [m[2], m[6], m[10], m[14]], [m[3], m[7], m[11], m[15]]];\n}\nfunction assertVectorsHaveEqualLengths(a, b) {\n  'worklet';\n\n  if (__DEV__ && a.length !== b.length) {\n    throw new _errors.ReanimatedError(`Cannot calculate inner product of two vectors of different lengths. Length of ${a.toString()} is ${a.length} and length of ${b.toString()} is ${b.length}.`);\n  }\n}\nfunction innerProduct(a, b) {\n  'worklet';\n\n  assertVectorsHaveEqualLengths(a, b);\n  return a.reduce(function (acc, _, i) {\n    return acc + a[i] * b[i];\n  }, 0);\n}\nfunction projection(u, a) {\n  'worklet';\n\n  assertVectorsHaveEqualLengths(u, a);\n  var s = innerProduct(u, a) / innerProduct(u, u);\n  return u.map(function (e) {\n    return e * s;\n  });\n}\nfunction subtractVectors(a, b) {\n  'worklet';\n\n  assertVectorsHaveEqualLengths(a, b);\n  return a.map(function (_, i) {\n    return a[i] - b[i];\n  });\n}\nfunction scaleVector(u, a) {\n  'worklet';\n\n  return u.map(function (e) {\n    return e * a;\n  });\n}\nfunction gramSchmidtAlgorithm(matrix) {\n  'worklet';\n\n  var _matrix = (0, _slicedToArray2.default)(matrix, 4),\n    a0 = _matrix[0],\n    a1 = _matrix[1],\n    a2 = _matrix[2],\n    a3 = _matrix[3];\n  var u0 = a0;\n  var u1 = subtractVectors(a1, projection(u0, a1));\n  var u2 = subtractVectors(subtractVectors(a2, projection(u0, a2)), projection(u1, a2));\n  var u3 = subtractVectors(subtractVectors(subtractVectors(a3, projection(u0, a3)), projection(u1, a3)), projection(u2, a3));\n  var _map = [u0, u1, u2, u3].map(function (u) {\n      return scaleVector(u, 1 / Math.sqrt(innerProduct(u, u)));\n    }),\n    _map2 = (0, _slicedToArray2.default)(_map, 4),\n    e0 = _map2[0],\n    e1 = _map2[1],\n    e2 = _map2[2],\n    e3 = _map2[3];\n  var rotationMatrix = [[e0[0], e1[0], e2[0], e3[0]], [e0[1], e1[1], e2[1], e3[1]], [e0[2], e1[2], e2[2], e3[2]], [e0[3], e1[3], e2[3], e3[3]]];\n  var skewMatrix = [[innerProduct(e0, a0), innerProduct(e0, a1), innerProduct(e0, a2), innerProduct(e0, a3)], [0, innerProduct(e1, a1), innerProduct(e1, a2), innerProduct(e1, a3)], [0, 0, innerProduct(e2, a2), innerProduct(e2, a3)], [0, 0, 0, innerProduct(e3, a3)]];\n  return {\n    rotationMatrix: transposeMatrix(rotationMatrix),\n    skewMatrix: transposeMatrix(skewMatrix)\n  };\n}\nfunction decomposeMatrix(unknownTypeMatrix) {\n  'worklet';\n\n  var matrix = maybeFlattenMatrix(unknownTypeMatrix);\n  if (matrix[15] === 0) {\n    throw new _errors.ReanimatedError('Invalid transform matrix.');\n  }\n  matrix.forEach(function (_, i) {\n    return matrix[i] /= matrix[15];\n  });\n  var translationMatrix = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 0], [matrix[12], matrix[13], matrix[14], 1]];\n  var sx = matrix[15] * norm3d(matrix[0], matrix[4], matrix[8]);\n  var sy = matrix[15] * norm3d(matrix[1], matrix[5], matrix[9]);\n  var sz = matrix[15] * norm3d(matrix[2], matrix[6], matrix[10]);\n  var scaleMatrix = [[sx, 0, 0, 0], [0, sy, 0, 0], [0, 0, sz, 0], [0, 0, 0, 1]];\n  var rotationAndSkewMatrix = [[matrix[0] / sx, matrix[1] / sx, matrix[2] / sx, 0], [matrix[4] / sy, matrix[5] / sy, matrix[6] / sy, 0], [matrix[8] / sz, matrix[9] / sz, matrix[10] / sz, 0], [0, 0, 0, 1]];\n  var _gramSchmidtAlgorithm = gramSchmidtAlgorithm(rotationAndSkewMatrix),\n    rotationMatrix = _gramSchmidtAlgorithm.rotationMatrix,\n    skewMatrix = _gramSchmidtAlgorithm.skewMatrix;\n  return {\n    translationMatrix: translationMatrix,\n    scaleMatrix: scaleMatrix,\n    rotationMatrix: rotationMatrix,\n    skewMatrix: skewMatrix\n  };\n}\nfunction decomposeMatrixIntoMatricesAndAngles(matrix) {\n  'worklet';\n  var _decomposeMatrix = decomposeMatrix(matrix),\n    scaleMatrix = _decomposeMatrix.scaleMatrix,\n    rotationMatrix = _decomposeMatrix.rotationMatrix,\n    translationMatrix = _decomposeMatrix.translationMatrix,\n    skewMatrix = _decomposeMatrix.skewMatrix;\n  var sinRy = -rotationMatrix[0][2];\n  var ry = Math.asin(sinRy);\n  var rx;\n  var rz;\n  if (sinRy === 1 || sinRy === -1) {\n    rz = 0;\n    rx = Math.atan2(sinRy * rotationMatrix[0][1], sinRy * rotationMatrix[0][2]);\n  } else {\n    rz = Math.atan2(rotationMatrix[0][1], rotationMatrix[0][0]);\n    rx = Math.atan2(rotationMatrix[1][2], rotationMatrix[2][2]);\n  }\n  return {\n    scaleMatrix: scaleMatrix,\n    rotationMatrix: rotationMatrix,\n    translationMatrix: translationMatrix,\n    skewMatrix: skewMatrix,\n    rx: rx || 0,\n    ry: ry || 0,\n    rz: rz || 0\n  };\n}","map":{"version":3,"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","addMatrices","decomposeMatrix","decomposeMatrixIntoMatricesAndAngles","flatten","getRotationMatrix","isAffineMatrix","isAffineMatrixFlat","multiplyMatrices","scaleMatrix","subtractMatrices","unflatten","_slicedToArray2","_errors","x","Array","isArray","length","every","element","isNaN","row","matrix","flat","m","maybeFlattenMatrix","a","b","maybeFlatA","maybeFlatB","isFlatOnStart","c","map","_","i","scalar","angle","axis","arguments","undefined","cos","Math","sin","norm3d","y","z","sqrt","transposeMatrix","assertVectorsHaveEqualLengths","__DEV__","ReanimatedError","toString","innerProduct","reduce","acc","projection","u","s","e","subtractVectors","scaleVector","gramSchmidtAlgorithm","_matrix","default","a0","a1","a2","a3","u0","u1","u2","u3","_map","_map2","e0","e1","e2","e3","rotationMatrix","skewMatrix","unknownTypeMatrix","forEach","translationMatrix","sx","sy","sz","rotationAndSkewMatrix","_gramSchmidtAlgorithm","_decomposeMatrix","sinRy","ry","asin","rx","rz","atan2"],"sources":["/Users/primopan/WebstormProjects/AsdLanguauge/AsdLanguage/node_modules/react-native-reanimated/src/animation/transformationMatrix/matrixUtils.tsx"],"sourcesContent":["'use strict';\n\nimport { ReanimatedError } from '../../errors';\n\ntype FixedLengthArray<\n  T,\n  L extends number,\n  PassedObject = [T, ...Array<T>],\n> = PassedObject & {\n  readonly length: L;\n  [I: number]: T;\n};\n\nexport type AffineMatrix = FixedLengthArray<FixedLengthArray<number, 4>, 4>;\n\nexport type AffineMatrixFlat = FixedLengthArray<number, 16>;\n\ntype TransformMatrixDecomposition = Record<\n  'translationMatrix' | 'scaleMatrix' | 'rotationMatrix' | 'skewMatrix',\n  AffineMatrix\n>;\n\ntype Axis = 'x' | 'y' | 'z';\n\ninterface TansformMatrixDecompositionWithAngles\n  extends TransformMatrixDecomposition {\n  rx: number;\n  ry: number;\n  rz: number;\n}\n\nexport function isAffineMatrixFlat(x: unknown): x is AffineMatrixFlat {\n  'worklet';\n  return (\n    Array.isArray(x) &&\n    x.length === 16 &&\n    x.every((element) => typeof element === 'number' && !isNaN(element))\n  );\n}\n\n// ts-prune-ignore-next This function is exported to be tested\nexport function isAffineMatrix(x: unknown): x is AffineMatrix {\n  'worklet';\n  return (\n    Array.isArray(x) &&\n    x.length === 4 &&\n    x.every(\n      (row) =>\n        Array.isArray(row) &&\n        row.length === 4 &&\n        row.every((element) => typeof element === 'number' && !isNaN(element))\n    )\n  );\n}\n\nexport function flatten(matrix: AffineMatrix): AffineMatrixFlat {\n  'worklet';\n  return matrix.flat() as AffineMatrixFlat;\n}\n\n// ts-prune-ignore-next This function is exported to be tested\nexport function unflatten(m: AffineMatrixFlat): AffineMatrix {\n  'worklet';\n  return [\n    [m[0], m[1], m[2], m[3]],\n    [m[4], m[5], m[6], m[7]],\n    [m[8], m[9], m[10], m[11]],\n    [m[12], m[13], m[14], m[15]],\n  ] as AffineMatrix;\n}\n\nfunction maybeFlattenMatrix(\n  matrix: AffineMatrix | AffineMatrixFlat\n): AffineMatrixFlat {\n  'worklet';\n  return isAffineMatrix(matrix) ? flatten(matrix) : matrix;\n}\n\nexport function multiplyMatrices(\n  a: AffineMatrix,\n  b: AffineMatrix\n): AffineMatrix {\n  'worklet';\n  return [\n    [\n      a[0][0] * b[0][0] +\n        a[0][1] * b[1][0] +\n        a[0][2] * b[2][0] +\n        a[0][3] * b[3][0],\n\n      a[0][0] * b[0][1] +\n        a[0][1] * b[1][1] +\n        a[0][2] * b[2][1] +\n        a[0][3] * b[3][1],\n\n      a[0][0] * b[0][2] +\n        a[0][1] * b[1][2] +\n        a[0][2] * b[2][2] +\n        a[0][3] * b[3][2],\n\n      a[0][0] * b[0][3] +\n        a[0][1] * b[1][3] +\n        a[0][2] * b[2][3] +\n        a[0][3] * b[3][3],\n    ],\n    [\n      a[1][0] * b[0][0] +\n        a[1][1] * b[1][0] +\n        a[1][2] * b[2][0] +\n        a[1][3] * b[3][0],\n\n      a[1][0] * b[0][1] +\n        a[1][1] * b[1][1] +\n        a[1][2] * b[2][1] +\n        a[1][3] * b[3][1],\n\n      a[1][0] * b[0][2] +\n        a[1][1] * b[1][2] +\n        a[1][2] * b[2][2] +\n        a[1][3] * b[3][2],\n\n      a[1][0] * b[0][3] +\n        a[1][1] * b[1][3] +\n        a[1][2] * b[2][3] +\n        a[1][3] * b[3][3],\n    ],\n    [\n      a[2][0] * b[0][0] +\n        a[2][1] * b[1][0] +\n        a[2][2] * b[2][0] +\n        a[2][3] * b[3][0],\n\n      a[2][0] * b[0][1] +\n        a[2][1] * b[1][1] +\n        a[2][2] * b[2][1] +\n        a[2][3] * b[3][1],\n\n      a[2][0] * b[0][2] +\n        a[2][1] * b[1][2] +\n        a[2][2] * b[2][2] +\n        a[2][3] * b[3][2],\n\n      a[2][0] * b[0][3] +\n        a[2][1] * b[1][3] +\n        a[2][2] * b[2][3] +\n        a[2][3] * b[3][3],\n    ],\n    [\n      a[3][0] * b[0][0] +\n        a[3][1] * b[1][0] +\n        a[3][2] * b[2][0] +\n        a[3][3] * b[3][0],\n\n      a[3][0] * b[0][1] +\n        a[3][1] * b[1][1] +\n        a[3][2] * b[2][1] +\n        a[3][3] * b[3][1],\n\n      a[3][0] * b[0][2] +\n        a[3][1] * b[1][2] +\n        a[3][2] * b[2][2] +\n        a[3][3] * b[3][2],\n\n      a[3][0] * b[0][3] +\n        a[3][1] * b[1][3] +\n        a[3][2] * b[2][3] +\n        a[3][3] * b[3][3],\n    ],\n  ];\n}\n\nexport function subtractMatrices<T extends AffineMatrixFlat | AffineMatrix>(\n  maybeFlatA: T,\n  maybeFlatB: T\n): T {\n  'worklet';\n  const isFlatOnStart = isAffineMatrixFlat(maybeFlatA);\n  const a: AffineMatrixFlat = maybeFlattenMatrix(maybeFlatA);\n  const b: AffineMatrixFlat = maybeFlattenMatrix(maybeFlatB);\n\n  const c = a.map((_, i) => a[i] - b[i]) as AffineMatrixFlat;\n  return isFlatOnStart ? (c as T) : (unflatten(c) as T);\n}\n\nexport function addMatrices<T extends AffineMatrixFlat | AffineMatrix>(\n  maybeFlatA: T,\n  maybeFlatB: T\n): T {\n  'worklet';\n  const isFlatOnStart = isAffineMatrixFlat(maybeFlatA);\n  const a = maybeFlattenMatrix(maybeFlatA);\n  const b = maybeFlattenMatrix(maybeFlatB);\n\n  const c = a.map((_, i) => a[i] + b[i]) as AffineMatrixFlat;\n  return isFlatOnStart ? (c as T) : (unflatten(c) as T);\n}\n\nexport function scaleMatrix<T extends AffineMatrixFlat | AffineMatrix>(\n  maybeFlatA: T,\n  scalar: number\n): T {\n  'worklet';\n  const isFlatOnStart = isAffineMatrixFlat(maybeFlatA);\n  const a = maybeFlattenMatrix(maybeFlatA);\n\n  const b = a.map((x) => x * scalar) as AffineMatrixFlat;\n  return isFlatOnStart ? (b as T) : (unflatten(b) as T);\n}\n\nexport function getRotationMatrix(\n  angle: number,\n  axis: Axis = 'z'\n): AffineMatrix {\n  'worklet';\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  switch (axis) {\n    case 'z':\n      return [\n        [cos, sin, 0, 0],\n        [-sin, cos, 0, 0],\n        [0, 0, 1, 0],\n        [0, 0, 0, 1],\n      ];\n    case 'y':\n      return [\n        [cos, 0, -sin, 0],\n        [0, 1, 0, 0],\n        [sin, 0, cos, 0],\n        [0, 0, 0, 1],\n      ];\n    case 'x':\n      return [\n        [1, 0, 0, 0],\n        [0, cos, sin, 0],\n        [0, -sin, cos, 0],\n        [0, 0, 0, 1],\n      ];\n  }\n}\n\nfunction norm3d(x: number, y: number, z: number) {\n  'worklet';\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\nfunction transposeMatrix(matrix: AffineMatrix): AffineMatrix {\n  'worklet';\n  const m = flatten(matrix);\n  return [\n    [m[0], m[4], m[8], m[12]],\n    [m[1], m[5], m[9], m[13]],\n    [m[2], m[6], m[10], m[14]],\n    [m[3], m[7], m[11], m[15]],\n  ];\n}\n\nfunction assertVectorsHaveEqualLengths(a: number[], b: number[]) {\n  'worklet';\n  if (__DEV__ && a.length !== b.length) {\n    throw new ReanimatedError(\n      `Cannot calculate inner product of two vectors of different lengths. Length of ${a.toString()} is ${\n        a.length\n      } and length of ${b.toString()} is ${b.length}.`\n    );\n  }\n}\n\nfunction innerProduct(a: number[], b: number[]) {\n  'worklet';\n  assertVectorsHaveEqualLengths(a, b);\n  return a.reduce((acc, _, i) => acc + a[i] * b[i], 0);\n}\n\nfunction projection(u: number[], a: number[]) {\n  'worklet';\n  assertVectorsHaveEqualLengths(u, a);\n  const s = innerProduct(u, a) / innerProduct(u, u);\n  return u.map((e) => e * s);\n}\n\nfunction subtractVectors(a: number[], b: number[]) {\n  'worklet';\n  assertVectorsHaveEqualLengths(a, b);\n  return a.map((_, i) => a[i] - b[i]);\n}\n\nfunction scaleVector(u: number[], a: number) {\n  'worklet';\n  return u.map((e) => e * a);\n}\n\nfunction gramSchmidtAlgorithm(matrix: AffineMatrix): {\n  rotationMatrix: AffineMatrix;\n  skewMatrix: AffineMatrix;\n} {\n  // Gram-Schmidt orthogonalization decomposes any matrix with non-zero determinant into an orthogonal and a triangular matrix\n  // These matrices are equal to rotation and skew matrices respectively, because we apply it to transformation matrix\n  // That is expected to already have extracted the remaining transforms (scale & translation)\n  'worklet';\n  const [a0, a1, a2, a3] = matrix;\n\n  const u0 = a0;\n  const u1 = subtractVectors(a1, projection(u0, a1));\n  const u2 = subtractVectors(\n    subtractVectors(a2, projection(u0, a2)),\n    projection(u1, a2)\n  );\n  const u3 = subtractVectors(\n    subtractVectors(\n      subtractVectors(a3, projection(u0, a3)),\n      projection(u1, a3)\n    ),\n    projection(u2, a3)\n  );\n\n  const [e0, e1, e2, e3] = [u0, u1, u2, u3].map((u) =>\n    scaleVector(u, 1 / Math.sqrt(innerProduct(u, u)))\n  );\n\n  const rotationMatrix: AffineMatrix = [\n    [e0[0], e1[0], e2[0], e3[0]],\n    [e0[1], e1[1], e2[1], e3[1]],\n    [e0[2], e1[2], e2[2], e3[2]],\n    [e0[3], e1[3], e2[3], e3[3]],\n  ];\n\n  const skewMatrix: AffineMatrix = [\n    [\n      innerProduct(e0, a0),\n      innerProduct(e0, a1),\n      innerProduct(e0, a2),\n      innerProduct(e0, a3),\n    ],\n    [0, innerProduct(e1, a1), innerProduct(e1, a2), innerProduct(e1, a3)],\n    [0, 0, innerProduct(e2, a2), innerProduct(e2, a3)],\n    [0, 0, 0, innerProduct(e3, a3)],\n  ];\n  return {\n    rotationMatrix: transposeMatrix(rotationMatrix),\n    skewMatrix: transposeMatrix(skewMatrix),\n  };\n}\n\n// ts-prune-ignore-next This function is exported to be tested\nexport function decomposeMatrix(\n  unknownTypeMatrix: AffineMatrixFlat | AffineMatrix\n): TransformMatrixDecomposition {\n  'worklet';\n  const matrix = maybeFlattenMatrix(unknownTypeMatrix);\n\n  // normalize matrix\n  if (matrix[15] === 0) {\n    throw new ReanimatedError('Invalid transform matrix.');\n  }\n  matrix.forEach((_, i) => (matrix[i] /= matrix[15]));\n\n  const translationMatrix: AffineMatrix = [\n    [1, 0, 0, 0],\n    [0, 1, 0, 0],\n    [0, 0, 1, 0],\n    [matrix[12], matrix[13], matrix[14], 1],\n  ];\n  const sx = matrix[15] * norm3d(matrix[0], matrix[4], matrix[8]);\n  const sy = matrix[15] * norm3d(matrix[1], matrix[5], matrix[9]);\n  const sz = matrix[15] * norm3d(matrix[2], matrix[6], matrix[10]);\n\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const scaleMatrix: AffineMatrix = [\n    [sx, 0, 0, 0],\n    [0, sy, 0, 0],\n    [0, 0, sz, 0],\n    [0, 0, 0, 1],\n  ];\n\n  const rotationAndSkewMatrix: AffineMatrix = [\n    [matrix[0] / sx, matrix[1] / sx, matrix[2] / sx, 0],\n    [matrix[4] / sy, matrix[5] / sy, matrix[6] / sy, 0],\n    [matrix[8] / sz, matrix[9] / sz, matrix[10] / sz, 0],\n    [0, 0, 0, 1],\n  ];\n\n  const { rotationMatrix, skewMatrix } = gramSchmidtAlgorithm(\n    rotationAndSkewMatrix\n  );\n\n  return {\n    translationMatrix,\n    scaleMatrix,\n    rotationMatrix,\n    skewMatrix,\n  };\n}\n\nexport function decomposeMatrixIntoMatricesAndAngles(\n  matrix: AffineMatrixFlat | AffineMatrix\n): TansformMatrixDecompositionWithAngles {\n  'worklet';\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const { scaleMatrix, rotationMatrix, translationMatrix, skewMatrix } =\n    decomposeMatrix(matrix);\n\n  const sinRy = -rotationMatrix[0][2];\n\n  const ry = Math.asin(sinRy);\n  let rx;\n  let rz;\n  if (sinRy === 1 || sinRy === -1) {\n    rz = 0;\n    rx = Math.atan2(sinRy * rotationMatrix[0][1], sinRy * rotationMatrix[0][2]);\n  } else {\n    rz = Math.atan2(rotationMatrix[0][1], rotationMatrix[0][0]);\n    rx = Math.atan2(rotationMatrix[1][2], rotationMatrix[2][2]);\n  }\n\n  return {\n    scaleMatrix,\n    rotationMatrix,\n    translationMatrix,\n    skewMatrix,\n    rx: rx || 0,\n    ry: ry || 0,\n    rz: rz || 0,\n  };\n}\n"],"mappings":"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C,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CACpB,EACD,CACED,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CACpB,EACD,CACED,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CACpB,EACD,CACED,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAEnBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACfD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GACjBD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}