{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _asyncToGenerator2=_interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));var _slicedToArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));var _react=_interopRequireWildcard(require(\"react\"));var _reactNative=require(\"react-native\");var _api=require(\"../../utils/api\");var _jsxRuntime=require(\"react/jsx-runtime\");function _getRequireWildcardCache(e){if(\"function\"!=typeof WeakMap)return null;var r=new WeakMap(),t=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(e){return e?t:r;})(e);}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(\"default\"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u];}return n.default=e,t&&t.set(e,n),n;}var GptTest=function GptTest(){var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2.default)(_useState,2),imagesData=_useState2[0],setImagesData=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=(0,_slicedToArray2.default)(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var handleGenerate=function(){var _ref=(0,_asyncToGenerator2.default)(function*(){setLoading(true);try{var _JSON$parse;var prompt=\"生成三个描述，每个描述用于图片生成。\";var response=yield(0,_api.gptQuery)(prompt);var descriptions=((_JSON$parse=JSON.parse(response))==null?void 0:_JSON$parse.response)||[];var imagePromises=descriptions.map(function(desc){return(0,_api.generateImage)(desc.描述).then(function(url){return Object.assign({},desc,{imageUrl:url});});});var generatedImages=yield Promise.all(imagePromises);setImagesData(generatedImages);}catch(error){_reactNative.Alert.alert('错误',error.message||'生成失败');}finally{setLoading(false);}});return function handleGenerate(){return _ref.apply(this,arguments);};}();return(0,_jsxRuntime.jsxs)(_reactNative.View,{style:styles.container,children:[(0,_jsxRuntime.jsx)(_reactNative.Button,{title:loading?'处理中...':'生成图片和描述',onPress:handleGenerate,disabled:loading}),(0,_jsxRuntime.jsx)(_reactNative.ScrollView,{contentContainerStyle:styles.scrollContainer,children:imagesData.map(function(item,index){return(0,_jsxRuntime.jsxs)(_reactNative.View,{style:styles.card,children:[(0,_jsxRuntime.jsx)(_reactNative.Image,{source:{uri:item.imageUrl},style:styles.image,resizeMode:\"contain\"}),(0,_jsxRuntime.jsx)(_reactNative.Text,{style:styles.description,children:item.描述})]},index);})})]});};var styles=_reactNative.StyleSheet.create({container:{flex:1,padding:16,backgroundColor:'#f5f5f5'},scrollContainer:{alignItems:'center',paddingVertical:16},card:{marginBottom:20,padding:16,borderWidth:1,borderColor:'#ccc',borderRadius:8,backgroundColor:'#fff',alignItems:'center',width:'90%'},image:{width:'100%',height:200,borderRadius:8,marginBottom:12},description:{fontSize:14,color:'#333',textAlign:'center'}});var _default=exports.default=GptTest;","map":{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_api","_jsxRuntime","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","GptTest","_useState","useState","_useState2","_slicedToArray2","imagesData","setImagesData","_useState3","_useState4","loading","setLoading","handleGenerate","_ref","_asyncToGenerator2","_JSON$parse","prompt","response","gptQuery","descriptions","JSON","parse","imagePromises","map","desc","generateImage","描述","then","url","assign","imageUrl","generatedImages","Promise","all","error","Alert","alert","message","apply","arguments","jsxs","View","style","styles","container","children","jsx","Button","title","onPress","disabled","ScrollView","contentContainerStyle","scrollContainer","item","index","card","Image","source","uri","image","resizeMode","Text","description","StyleSheet","create","flex","padding","backgroundColor","alignItems","paddingVertical","marginBottom","borderWidth","borderColor","borderRadius","width","height","fontSize","color","textAlign","_default","exports"],"sources":["/Users/primopan/WebstormProjects/AsdLanguauge/AsdLanguage/SourceCode/Components/GptTest/index.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { View, Button, StyleSheet, Text, ScrollView, Image, Alert } from 'react-native';\nimport { gptQuery, generateImage } from '../../utils/api'; // 引入封装的接口\n\nconst GptTest = () => {\n    const [imagesData, setImagesData] = useState([]); // 图片和描述的数据数组\n    const [loading, setLoading] = useState(false); // 加载状态\n    const handleGenerate = async () => {\n        setLoading(true);\n        try {\n            // 调用 GPT 接口生成描述\n            const prompt = \"生成三个描述，每个描述用于图片生成。\";\n            const response = await gptQuery(prompt);\n            const descriptions = JSON.parse(response)?.response || [];\n\n            // 调用图片生成接口为每个描述生成图片\n            const imagePromises = descriptions.map((desc) =>\n                generateImage(desc.描述).then((url) => ({ ...desc, imageUrl: url }))\n            );\n            const generatedImages = await Promise.all(imagePromises);\n\n            setImagesData(generatedImages);\n        } catch (error) {\n            Alert.alert('错误', error.message || '生成失败');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <View style={styles.container}>\n            <Button\n                title={loading ? '处理中...' : '生成图片和描述'}\n                onPress={handleGenerate}\n                disabled={loading}\n            />\n            <ScrollView contentContainerStyle={styles.scrollContainer}>\n                {imagesData.map((item, index) => (\n                    <View key={index} style={styles.card}>\n                        <Image source={{ uri: item.imageUrl }} style={styles.image} resizeMode=\"contain\" />\n                        <Text style={styles.description}>{item.描述}</Text>\n                    </View>\n                ))}\n            </ScrollView>\n        </View>\n    );\n};\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        padding: 16,\n        backgroundColor: '#f5f5f5',\n    },\n    scrollContainer: {\n        alignItems: 'center',\n        paddingVertical: 16,\n    },\n    card: {\n        marginBottom: 20,\n        padding: 16,\n        borderWidth: 1,\n        borderColor: '#ccc',\n        borderRadius: 8,\n        backgroundColor: '#fff',\n        alignItems: 'center',\n        width: '90%',\n    },\n    image: {\n        width: '100%',\n        height: 200,\n        borderRadius: 8,\n        marginBottom: 12,\n    },\n    description: {\n        fontSize: 14,\n        color: '#333',\n        textAlign: 'center',\n    },\n});\n\nexport default GptTest;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}